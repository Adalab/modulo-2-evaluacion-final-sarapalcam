"use strict";const input=document.querySelector(".js-input"),searchBtn=document.querySelector(".js-search-btn"),resetBtn=document.querySelector(".js-reset-btn"),favList=document.querySelector(".js-favorites-list"),resetFavoritesBtn=document.querySelector(".js-reset-favorites-btn"),resultList=document.querySelector(".js-result-list"),headerMenu=document.querySelector(".js-header-menu"),favoritesSection=document.querySelector(".js-favorites-section"),resultsArrow=document.querySelector(".js-results-arrow"),body=document.querySelector(".js-body");let favorites=[],results=[];function getInputValue(){return input.value}function fetchData(){const e=getInputValue();fetch("https://api.jikan.moe/v3/search/anime?q="+e).then(e=>e.json()).then(e=>{results=[];for(const t of e.results)results.push(t);renderResults(results)})}function setDefaultImage(e,t){t.src=null===e?"https://via.placeholder.com/225x317/ffffff/666666/?text=TV":e}function createCoverImgResult(e){const t=document.createElement("img");return setDefaultImage(e.image_url,t),t.style="height: 317px; width: 225px; background-size: cover",t.alt="Imagen de portada de "+e.title,t.title="Imagen de portada de "+e.title,t}function createParagraphResult(e){const t=document.createElement("p"),s=document.createTextNode(""+e.title);return t.appendChild(s),t}function createFavoritesImgResult(){const e=document.createElement("img");return e.src="./assets/images/favorite.png",e.alt="Corazón de favorito",e.title="Corazón de favorito",e.classList.add("anime__results--list--heart"),e.classList.add("hidden"),e}function appendElementsToResult(e,t){const s=createCoverImgResult(e),r=createParagraphResult(e),o=createFavoritesImgResult();t.appendChild(s),t.appendChild(r),t.appendChild(o)}function addListenerToResultLi(e){e.addEventListener("click",handleClickListElement)}function createLiResult(e){const t=document.createElement("li");return t.id=""+e.mal_id,t.classList.add("js-li-results"),t.classList.add("anime__results--list--el"),appendElementsToResult(e,t),addListenerToResultLi(t),t}function renderResults(e){resultList.innerHTML="";for(const t of e){const e=createLiResult(t);resultList.appendChild(e)}showHighlitedResults()}function toggleFavoriteClass(e){e.currentTarget.classList.toggle("favorite"),e.currentTarget.childNodes[2].classList.toggle("hidden")}function createNewFavoriteObject(e){return{id:e.currentTarget.id,image_url:e.currentTarget.childNodes[0].currentSrc,title:e.currentTarget.childNodes[1].innerText}}function updateFavoritesList(e){const t=createNewFavoriteObject(e),s=e.currentTarget.id;if(void 0===favorites.find(e=>e.id===s))favorites.push(t);else{const e=favorites.findIndex(e=>e.id===s);favorites.splice(e,1)}}function createCoverFavorite(e){const t=document.createElement("img");return t.src=e.image_url,t.style="height: 170px; width: 121px; background-size: cover",t.alt="Imagen de portada de "+e.title,t.title="Imagen de portada de "+e.title,t}function createParagraphFavorite(e){const t=document.createElement("p"),s=document.createTextNode(""+e.title);return t.appendChild(s),t}function appendElementsToFavoriteDiv(e,t){const s=createCoverFavorite(e),r=createParagraphFavorite(e);return t.appendChild(s),t.appendChild(r),t}function createDivFavorite(e){const t=document.createElement("div");t.classList.add("anime__favorites--list--container");return appendElementsToFavoriteDiv(e,t)}function createRemoveIconFavorite(){const e=document.createElement("i");return e.classList.add("fas"),e.classList.add("fa-times-circle"),e.classList.add("js-remove-favorite"),e.classList.add("anime__favorites--list--remove"),e}function appendElementsToFavoriteList(e,t){const s=createDivFavorite(e),r=createRemoveIconFavorite();t.appendChild(s),t.appendChild(r)}function createLiFavorite(e){const t=document.createElement("li");return t.id=""+e.id,t.classList.add("anime__favorites--list--el"),appendElementsToFavoriteList(e,t),t}function addListenerToRemoveIcons(){const e=document.querySelectorAll(".js-remove-favorite");for(const t of e)t.addEventListener("click",handleClickRemoveIcon);updateStatusResetBtn()}function saveFavoritesArray(){localStorage.setItem("favorites",JSON.stringify(favorites))}function renderFavorites(){favList.classList.remove("hidden"),favList.innerHTML="";for(const e of favorites){const t=createLiFavorite(e);favList.appendChild(t)}addListenerToRemoveIcons(),saveFavoritesArray()}function addToFavorites(e){updateFavoritesList(e),renderFavorites()}function deleteHighlitedResults(e){const t=e.currentTarget.parentNode.id,s=document.querySelectorAll(".js-li-results");for(const e of s)t===e.id&&(e.classList.remove("favorite"),e.childNodes[2].classList.add("hidden"))}function removeFromFavorites(e){const t=e.currentTarget.parentNode.id,s=favorites.findIndex(e=>e.id===t);favorites.splice(s,1),deleteHighlitedResults(e),renderFavorites()}function resetResults(){input.value="",resultList.innerHTML=""}function deleteAllHighlitedResults(){const e=document.querySelectorAll(".js-li-results");for(const t of e)t.classList.remove("favorite"),t.childNodes[2].classList.add("hidden")}function removeAllFavorites(){favorites=[],localStorage.clear("favorites"),deleteAllHighlitedResults(),renderFavorites()}function showHighlitedResults(){const e=document.querySelectorAll(".js-li-results");for(const t of e)for(const e of favorites)e.id===t.id&&(t.classList.add("favorite"),t.childNodes[2].classList.remove("hidden"))}function restoreSavedFavorites(){null!==localStorage.getItem("favorites")&&(favorites=JSON.parse(localStorage.getItem("favorites")),renderFavorites())}function turnResetBtnOn(){resetFavoritesBtn.classList.remove("anime__favorites--btn--off"),resetFavoritesBtn.classList.add("anime__favorites--btn--on")}function turnResetBtnOff(){resetFavoritesBtn.classList.add("anime__favorites--btn--off"),resetFavoritesBtn.classList.remove("anime__favorites--btn--on")}function enableResetFavoritesBtn(){resetFavoritesBtn.disabled=!1,turnResetBtnOn()}function disableResetFavoritesBtn(){resetFavoritesBtn.disabled=!0,turnResetBtnOff()}function updateStatusResetBtn(){""===favList.innerHTML?disableResetFavoritesBtn():enableResetFavoritesBtn()}function toggleOverflowFavorites(){favoritesSection.classList.toggle("overflow__scroll")}function removeOverflow(){body.classList.remove("overflow__hidden"),favoritesSection.classList.remove("overflow__scroll")}function toggleOverflowBody(){body.classList.toggle("overflow__hidden")}function toggleShowFavorites(){favoritesSection.classList.toggle("hidden")}function toggleMenuRotation(){headerMenu.classList.toggle("rotate")}function scrollToTop(){window.scrollTo(0,0)}function handleClickSearch(e){e.preventDefault(),fetchData(),resultsArrow.classList.remove("hidden")}function handleClickListElement(e){toggleFavoriteClass(e),enableResetFavoritesBtn(),addToFavorites(e)}function handleClickRemoveIcon(e){removeFromFavorites(e)}function handleClickReset(e){e.preventDefault(),resetResults(),resultsArrow.classList.add("hidden")}function handleClickResetFavs(e){e.preventDefault(),removeOverflow(),removeAllFavorites(),toggleMenuRotation(),favoritesSection.classList.add("hidden")}function handleClickHeader(){toggleOverflowBody(),toggleOverflowFavorites(),toggleShowFavorites(),toggleMenuRotation(),scrollToTop()}function handleClickArrow(){scrollToTop()}restoreSavedFavorites(),updateStatusResetBtn(),searchBtn.addEventListener("click",handleClickSearch),resetBtn.addEventListener("click",handleClickReset),resetFavoritesBtn.addEventListener("click",handleClickResetFavs),headerMenu.addEventListener("click",handleClickHeader),resultsArrow.addEventListener("click",handleClickArrow);